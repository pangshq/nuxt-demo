{"file":"default-CXfOBRpo.js","mappings":";;;;;;;;;;;;;;;;;;;;;AAIa,QAAI,KAAK;AACR,QAAI,EAAE;AACJ,QAAI,KAAK;AACR,QAAW;AAAA,MAC1B,EAAE,MAAM,aAAa,MAAM,iCAAiC,MAAM,KAAK,MAAI;AAAA,IAAE,CAC9E;;;;;;;;;;;;;;;;;;;;;;ACJM,YAAA,OAAAA,eAAAC,WAAA,EAAA,OAAM,gBAAY,MAAA,CAAA,CAAA,mBAAA;;;;QAGT,OAAA;AAAA,QAAM,OAAA;AAAA,QAAM,aAAA;AAAA,QAAY,0BAAA;AAAA,MAAA;yBAApC,CAKa,GAAAC,QAAAC,UAAA,aAAA;;;cAJM,SAAA;AAAA,cAAQ,IAAG;AAAA,cAAI,MAAK;AAAA,YAAA;+BAArC,CAAkEC,IAAAF,QAAAC,UAAAE,cAAA;;;;;oCAApB,IAAE;AAAA,kBAAA;AAAA;;;;;cAC/B,SAAA;AAAA,cAAQ,IAAG;AAAA,cAAY,MAAK;AAAA,YAAA;+BAA7C,CAA0ED,IAAAF,QAAAC,UAAAE,cAAA;;;;;oCAApB,IAAE;AAAA,kBAAA;AAAA;;;;;cACvC,SAAA;AAAA,cAAQ,IAAG;AAAA,cAAS,MAAK;AAAA,YAAA;+BAA1C,CAAuED,IAAAF,QAAAC,UAAAE,cAAA;;;;;oCAApB,IAAE;AAAA,kBAAA;AAAA;;;;;cACpC,SAAA;AAAA,cAAQ,IAAG;AAAA,cAAM,MAAK;AAAA,YAAA;+BAAvC,CAAoED,IAAAF,QAAAC,UAAAE,cAAA;;;;;oCAApB,IAAE;AAAA,kBAAA;AAAA;;;;;;cAHlDC,YAAkE,4BAAA;AAAA,gBAAjD,SAAA;AAAA,gBAAQ,IAAG;AAAA,gBAAI,MAAK;AAAA,cAAA;iCAAS,MAAE;AAAA,kCAAF,IAAE;AAAA,gBAAA;;;cAChDA,YAA0E,4BAAA;AAAA,gBAAzD,SAAA;AAAA,gBAAQ,IAAG;AAAA,gBAAY,MAAK;AAAA,cAAA;iCAAS,MAAE;AAAA,kCAAF,IAAE;AAAA,gBAAA;;;cACxDA,YAAuE,4BAAA;AAAA,gBAAtD,SAAA;AAAA,gBAAQ,IAAG;AAAA,gBAAS,MAAK;AAAA,cAAA;iCAAS,MAAE;AAAA,kCAAF,IAAE;AAAA,gBAAA;;;cACrDA,YAAoE,4BAAA;AAAA,gBAAnD,SAAA;AAAA,gBAAQ,IAAG;AAAA,gBAAM,MAAK;AAAA,cAAA;iCAAS,MAAE;AAAA,kCAAF,IAAE;AAAA,gBAAA;;;;;;;;;;;;;;;;;;;","names":["_ssrRenderAttrs","_mergeProps","_push","_parent","_","_scopeId","_createVNode"],"sources":["../../../../../../../components/ChatWidget.vue","../../../../../../../layouts/default.vue"],"sourcesContent":["<script setup lang=\"ts\">\n// Floating chat widget + bottom popup (50% height)\ntype Msg = { role: 'user' | 'assistant'; text: string; time: number }\n\nconst open = ref(false)\nconst input = ref('')\nconst loading = ref(false)\nconst messages = ref<Msg[]>([\n  { role: 'assistant', text: '您好，我是智能客服。可以问我关于页面功能、基金指标等问题~', time: Date.now() },\n])\n\nconst send = async () => {\n  const text = input.value.trim()\n  if (!text) return\n  input.value = ''\n  messages.value.push({ role: 'user', text, time: Date.now() })\n  loading.value = true\n  try {\n    const res = await $fetch<{ reply: string }>('/api/ai/chat', {\n      method: 'POST',\n      body: { text },\n      headers: { 'content-type': 'application/json' },\n    })\n    messages.value.push({ role: 'assistant', text: res.reply, time: Date.now() })\n  } catch (e) {\n    messages.value.push({ role: 'assistant', text: '抱歉，服务暂时不可用，请稍后再试。', time: Date.now() })\n  } finally {\n    loading.value = false\n    // scroll to bottom next tick\n    await nextTick()\n    const pane = document.querySelector('.ai-chat-pane .list') as HTMLElement | null\n    pane && pane.scrollTo({ top: pane.scrollHeight })\n  }\n}\n\nconst onToggle = () => (open.value = !open.value)\n</script>\n\n<template>\n  <client-only>\n    <div>\n      <van-floating-bubble axis=\"xy\" icon=\"chat-o\" :offset=\"{ x: 20, y: 100 }\" teleport=\"body\" @click=\"onToggle\" />\n\n      <van-popup v-model:show=\"open\" position=\"bottom\" class=\"ai-chat-pane\" :style=\"{ height: '50vh' }\" round safe-area-inset-bottom>\n        <div class=\"hd\">\n          <div class=\"title\">AI 智能客服</div>\n          <van-icon name=\"cross\" size=\"18\" @click=\"open = false\" />\n        </div>\n        <div class=\"list\">\n          <div v-for=\"m in messages\" :key=\"m.time\" class=\"msg\" :class=\"m.role\">\n            <div class=\"bubble\">{{ m.text }}</div>\n          </div>\n          <van-loading v-if=\"loading\" size=\"20\" class=\"loading\" />\n        </div>\n        <div class=\"input\">\n          <van-field v-model=\"input\" placeholder=\"请输入问题，例如：近1年回撤多少？\" clearable @keyup.enter=\"send\" />\n          <van-button type=\"primary\" size=\"small\" :loading=\"loading\" @click=\"send\">发送</van-button>\n        </div>\n      </van-popup>\n    </div>\n  </client-only>\n</template>\n\n<style scoped>\n.ai-chat-pane { display: flex; flex-direction: column; padding: 8px 8px 12px; }\n.hd { display: flex; align-items: center; justify-content: space-between; padding: 6px 4px 8px; }\n.title { font-weight: 600; }\n.list { flex: 1; overflow-y: auto; padding: 8px 4px; }\n.msg { display: flex; margin: 6px 0; }\n.msg.user { justify-content: flex-end; }\n.msg .bubble { max-width: 80%; padding: 8px 10px; border-radius: 12px; line-height: 1.3; }\n.msg.user .bubble { background: #1989fa; color: #fff; border-bottom-right-radius: 4px; }\n.msg.assistant .bubble { background: #f5f5f5; color: #333; border-bottom-left-radius: 4px; }\n.input { display: flex; gap: 8px; align-items: center; padding-top: 6px; }\n.input :deep(.van-field) { flex: 1; background: #f7f8fa; border-radius: 8px; }\n.loading { display: flex; justify-content: center; padding: 8px 0; }\n</style>\n","<script setup lang=\"ts\">\n// Global layout with a bottom Tabbar\n</script>\n\n<template>\n  <div class=\"app-layout\">\n    <slot />\n    <ChatWidget />\n    <van-tabbar route fixed placeholder safe-area-inset-bottom>\n      <van-tabbar-item replace to=\"/\" icon=\"home-o\">主页</van-tabbar-item>\n      <van-tabbar-item replace to=\"/strategy\" icon=\"bulb-o\">策略</van-tabbar-item>\n      <van-tabbar-item replace to=\"/tools\" icon=\"apps-o\">工具</van-tabbar-item>\n      <van-tabbar-item replace to=\"/me\" icon=\"user-o\">我的</van-tabbar-item>\n    </van-tabbar>\n  </div>\n  \n</template>\n\n<style scoped>\n.app-layout { min-height: 100vh; background: #f7f8fa; }\n</style>\n"],"version":3}