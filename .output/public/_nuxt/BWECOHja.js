import{d as R,r as w,o as I,J as q,K as F,L as $,z as S,D as v,A as a,M as D,N,O as M,P as U,_ as W,H as te,k as x,Q as ae,y as P,C as r,E as k,B as h,G as o,I as C,R as se,S as ne,g as b,q as oe}from"#entry";import{u as ie}from"./D7ounY5O.js";const le=R({__name:"FundLineChart",props:{x:{},series:{},height:{},visible:{type:Boolean,default:!0}},setup(y){const i=y,n=w(null);let s,d=null;const g=()=>{s&&(s.dispose(),s=null)},p=async()=>{if(!n.value)return;let t=0;for(;n.value&&n.value.clientWidth===0&&t<30;)await new Promise(c=>requestAnimationFrame(c)),t++},u=async()=>{if(!n.value||!i.visible)return;const t=await N(()=>import("./ChRfpd74.js"),[],import.meta.url);await p(),s=s||t.init(n.value,void 0,{renderer:"canvas"});const c=i.series.map(m=>m.color).filter(Boolean),l={color:c.length?c:void 0,grid:{left:12,right:12,top:16,bottom:24,containLabel:!0},tooltip:{trigger:"axis",axisPointer:{type:"line"},valueFormatter:m=>`${m.toFixed(2)}%`},xAxis:{type:"category",boundaryGap:!1,data:i.x,axisLine:{show:!1},axisTick:{show:!1},axisLabel:{color:"#999"}},yAxis:{type:"value",axisLabel:{formatter:"{value}%",color:"#999"},splitLine:{lineStyle:{color:"#eee"}}},series:i.series.map(m=>({type:"line",name:m.name,data:m.data,smooth:!0,symbol:"none",lineStyle:{width:2},areaStyle:m.area?{opacity:.15}:void 0})),legend:{top:0,icon:"circle",itemWidth:8,itemHeight:8,textStyle:{color:"#666"}}};s.setOption(l,!0),s.resize()};return I(()=>{i.visible&&requestAnimationFrame(()=>requestAnimationFrame(()=>u()));const t=()=>s&&s.resize();window.addEventListener("resize",t),"ResizeObserver"in window&&n.value&&(d=new ResizeObserver(()=>s&&s.resize()),d.observe(n.value)),q(()=>{window.removeEventListener("resize",t),d&&d.disconnect(),g()})}),F(()=>({x:i.x,s:i.series}),()=>u(),{deep:!0}),F(()=>i.visible,async t=>{t&&(await U(),requestAnimationFrame(()=>requestAnimationFrame(()=>u())))}),(t,c)=>{const l=M;return S(),$(l,null,{default:v(()=>[a("div",{ref_key:"chartEl",ref:n,style:D({height:(y.height??260)+"px",width:"100%"})},null,4)]),_:1})}}}),re=Object.assign(W(le,[["__scopeId","data-v-10a423c2"]]),{__name:"FundLineChart"}),ce=R({__name:"EChartBase",props:{option:{},height:{},visible:{type:Boolean,default:!0}},setup(y){const i=y,n=w(null);let s,d=null;const g=()=>{s&&(s.dispose(),s=null)},p=async()=>{if(!n.value)return;let t=0;for(;n.value&&n.value.clientWidth===0&&t<30;)await new Promise(c=>requestAnimationFrame(c)),t++},u=async()=>{if(!n.value||!i.visible)return;const t=await N(()=>import("./ChRfpd74.js"),[],import.meta.url);await p(),s=s||t.init(n.value),s.setOption(i.option,!0),s.resize()};return I(()=>{i.visible&&requestAnimationFrame(()=>requestAnimationFrame(()=>u()));const t=()=>s&&s.resize();window.addEventListener("resize",t),"ResizeObserver"in window&&n.value&&(d=new ResizeObserver(()=>s&&s.resize()),d.observe(n.value)),q(()=>{window.removeEventListener("resize",t),d&&d.disconnect(),g()})}),F(()=>i.option,()=>u(),{deep:!0}),F(()=>i.visible,async t=>{t&&(await U(),requestAnimationFrame(()=>requestAnimationFrame(()=>u())))}),(t,c)=>{const l=M;return S(),$(l,null,{default:v(()=>[a("div",{ref_key:"chartEl",ref:n,style:D({height:(y.height??260)+"px",width:"100%"})},null,4)]),_:1})}}}),de=Object.assign(ce,{__name:"EChartBase"}),ue=globalThis.setInterval,ve={class:"page"},_e={class:"card header"},pe={class:"title"},me={class:"code"},fe={class:"tags"},he={class:"kpis"},be={class:"kpi"},ye={class:"value neg"},xe={class:"kpi"},we={class:"value"},ge={class:"kpi"},ke={class:"value neg"},Fe={class:"kpi"},Le={class:"value"},ze={class:"card"},Ae={class:"tabs"},Ee={class:"toolbar"},Se={class:"rt"},Ce={class:"tab-head"},Re={class:"range"},qe=5e3,Be=R({__name:"[code]",async setup(y){let i,n;const s=te(),d=x(()=>String(s.params.code||"")),g=[{key:"ytd",label:"今年来"},{key:"1m",label:"近1月"},{key:"3m",label:"近3月"},{key:"6m",label:"近6月"},{key:"1y",label:"近1年"}],p=w("1y"),u=w(!0),t=w("trend"),c=w(!1),{data:l,pending:m,refresh:j}=([i,n]=ae(()=>ie(()=>`/api/fund/${d.value}`,{query:{range:p},watch:[p,d]},"$Dbwr6Tj7kR")),i=await i,n(),i),L=x(()=>l.value?.chart.x??[]),G=x(()=>{const f=l.value?.chart.fund??[],e=l.value?.chart.bench??[],A=[{name:"本基金",data:f,color:"#ff4d4f",area:!0}];return u.value&&A.push({name:"沪深300",data:e,color:"#2f88ff"}),A}),H=x(()=>[{name:"最大回撤",data:l.value?.chart.drawdown??[],color:"#ff7a45",area:!0}]),J=x(()=>{const f=l.value?.chart.nav??[];return{grid:{left:12,right:12,top:16,bottom:24,containLabel:!0},tooltip:{trigger:"axis",valueFormatter:e=>e.toFixed(4)},xAxis:{type:"category",boundaryGap:!1,data:L.value,axisLine:{show:!1},axisTick:{show:!1},axisLabel:{color:"#999"}},yAxis:{type:"value",axisLabel:{color:"#999"},splitLine:{lineStyle:{color:"#eee"}}},series:[{type:"line",data:f,smooth:!0,symbol:"none",lineStyle:{width:2,color:"#2f88ff"}}]}}),K=x(()=>{const f=l.value?.chart.volume??[];return{grid:{left:12,right:12,top:16,bottom:24,containLabel:!0},tooltip:{trigger:"axis",valueFormatter:e=>`${e.toFixed(0)}k`},xAxis:{type:"category",data:L.value,axisLabel:{color:"#999"},axisTick:{show:!1},axisLine:{show:!1}},yAxis:{type:"value",axisLabel:{color:"#999",formatter:"{value}k"},splitLine:{lineStyle:{color:"#eee"}}},series:[{type:"bar",data:f,itemStyle:{color:"#91cc75"},barMaxWidth:10}]}}),Q=()=>history.length>1?history.back():oe("/");let z=null;const B=()=>{z&&(clearInterval(z),z=null)};return F(c,f=>{B(),f&&(z=ue(()=>j(),qe))}),q(()=>B()),(f,e)=>{const A=b("van-nav-bar"),O=b("van-tag"),X=b("van-switch"),Y=b("van-checkbox"),T=re,E=b("van-tab"),V=de,Z=b("van-tabs"),ee=b("van-button");return S(),P("div",ve,[r(A,{title:"基金详情","left-arrow":"",onClickLeft:Q}),a("div",_e,[a("div",pe,[k(h(o(l)?.info.name),1),a("span",me,h(o(l)?.info.code),1)]),a("div",fe,[r(O,{type:"primary",plain:"",round:""},{default:v(()=>[...e[3]||(e[3]=[k("场内交易",-1)])]),_:1}),r(O,{plain:"",round:""},{default:v(()=>[...e[4]||(e[4]=[k("股票指数",-1)])]),_:1})]),a("div",he,[a("div",be,[a("div",ye,h((o(l)?.info.dayChangePct??0).toFixed(2))+"%",1),e[5]||(e[5]=a("div",{class:"label"},"日涨跌幅",-1))]),a("div",xe,[a("div",we,h((o(l)?.info.ytdPct??0).toFixed(2))+"%",1),e[6]||(e[6]=a("div",{class:"label"},"今年以来",-1))]),a("div",ge,[a("div",ke,h((o(l)?.info.sinceInceptionAnnualPct??0).toFixed(2))+"%",1),e[7]||(e[7]=a("div",{class:"label"},"成立来年化",-1))]),a("div",Fe,[a("div",Le,h((o(l)?.info.latestNav??0).toFixed(4)),1),e[8]||(e[8]=a("div",{class:"label"},"最新净值",-1))])])]),a("div",ze,[a("div",Ae,[a("div",Ee,[e[10]||(e[10]=a("div",{class:"spacer"},null,-1)),a("div",Se,[e[9]||(e[9]=a("span",{class:"label"},"实时更新",-1)),r(X,{modelValue:o(c),"onUpdate:modelValue":e[0]||(e[0]=_=>C(c)?c.value=_:null),size:"20"},null,8,["modelValue"])])]),r(Z,{active:o(t),"onUpdate:active":e[2]||(e[2]=_=>C(t)?t.value=_:null),shrink:"",sticky:"","offset-top":46,"lazy-render":!1},{default:v(()=>[r(E,{name:"trend",title:"业绩走势"},{default:v(()=>[a("div",Ce,[r(Y,{modelValue:o(u),"onUpdate:modelValue":e[1]||(e[1]=_=>C(u)?u.value=_:null),shape:"square","icon-size":"16"},{default:v(()=>[...e[11]||(e[11]=[k(" 沪深300 ",-1)])]),_:1},8,["modelValue"])]),r(T,{x:o(L),series:o(G),height:260,visible:o(t)==="trend"},null,8,["x","series","visible"])]),_:1}),r(E,{name:"drawdown",title:"回撤"},{default:v(()=>[r(T,{x:o(L),series:o(H),height:260,visible:o(t)==="drawdown"},null,8,["x","series","visible"])]),_:1}),r(E,{name:"nav",title:"净值"},{default:v(()=>[r(V,{option:o(J),height:260,visible:o(t)==="nav"},null,8,["option","visible"])]),_:1}),r(E,{name:"volume",title:"成交量"},{default:v(()=>[r(V,{option:o(K),height:260,visible:o(t)==="volume"},null,8,["option","visible"])]),_:1})]),_:1},8,["active"])]),a("div",Re,[(S(),P(se,null,ne(g,_=>r(ee,{key:_.key,size:"small",round:"",type:o(p)===_.key?"primary":"default",plain:"",onClick:Oe=>p.value=_.key},{default:v(()=>[k(h(_.label),1)]),_:2},1032,["type","onClick"])),64))])]),e[12]||(e[12]=a("div",{class:"placeholder"},null,-1))])}}}),Pe=W(Be,[["__scopeId","data-v-aecb4abc"]]);export{Pe as default};
